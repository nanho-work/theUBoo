<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì£¼ì†Œ ê²€ìƒ‰ ê²°ê³¼</title>
  <script>
    // jusoCallBack ë””ë²„ê¹…: postMessage ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€, origin ì œí•œ
    window.jusoCallBack = function (
      roadFullAddr, roadAddrPart1, roadAddrPart2, engAddr,
      jibunAddr, zipNo, admCd, rnMgtSn, bdMgtSn,
      detBdNmList, bdNm, bdKdcd, siNm, sggNm, emdNm,
      liNm, rn, udrtYn, buldMnnm, buldSlno, mtYn, lnbrMnnm,
      lnbrSlno, emdNo
    ) {
      console.log("ğŸ jusoCallBack ì‹¤í–‰ë¨!");
      console.log("ğŸ“¦ ì „ë‹¬í•  ë°ì´í„°:", { zipNo, roadAddr: roadAddrPart1 });

      // Debug: log before postMessage
      if (window.opener) {
        console.log("ğŸ§© opener ì¡´ì¬í•¨. ë©”ì‹œì§€ ì „ì†¡ ì‹œì‘");
        try {
          // Use "*" as targetOrigin for now (for testing/cross-origin)
          window.opener.postMessage({
            zipNo,
            roadAddr: roadAddrPart1
          }, "*");
          setTimeout(() => {
            console.log("ğŸ§¨ ì°½ ë‹«ê¸° ì‹¤í–‰ë¨");
            window.close();
          }, 300);
        } catch (e) {
          console.error("ğŸ”¥ postMessage ì‹¤íŒ¨:", e);
        }
      } else {
        console.log("ğŸš« window.openerê°€ nullì„");
        alert("ë¶€ëª¨ ì°½ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ ì°½ì„ ë‹«ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }
      // Debug: after postMessage/jusoCallBack
      console.log("âœ… jusoCallBack í•¨ìˆ˜ ì¢…ë£Œ");
    };

    window.addEventListener("DOMContentLoaded", () => {
      console.log("ğŸŒ í˜„ì¬ URL:", window.location.href);
      console.log("âœ… juso_callback.html ë¡œë“œë¨");

      const params = new URLSearchParams(window.location.search);
      const zipNo = params.get("zipNo");
      const roadAddrPart1 = params.get("roadAddrPart1");

      console.log("ğŸ“¦ íŒŒë¼ë¯¸í„° zipNo:", zipNo);
      console.log("ğŸ“¦ íŒŒë¼ë¯¸í„° roadAddrPart1:", roadAddrPart1);

      // Check for both parameters and non-empty string values
      if (typeof zipNo === "string" && zipNo.trim() !== "" &&
          typeof roadAddrPart1 === "string" && roadAddrPart1.trim() !== "") {
        console.log("ğŸ“¬ í…ŒìŠ¤íŠ¸ìš© jusoCallBack ìë™ ì‹¤í–‰ ì‹œì‘");
        jusoCallBack(
          '', roadAddrPart1, '', '', '', zipNo, '', '', '',
          '', '', '', '', '', '',
          '', '', '', '', '', '',
          '', ''
        );
      } else {
        let reason = [];
        if (!zipNo || typeof zipNo !== "string" || zipNo.trim() === "") reason.push("zipNo ì—†ìŒ/ë¹ˆê°’");
        if (!roadAddrPart1 || typeof roadAddrPart1 !== "string" || roadAddrPart1.trim() === "") reason.push("roadAddrPart1 ì—†ìŒ/ë¹ˆê°’");
        console.warn("âš ï¸ URL íŒŒë¼ë¯¸í„° ë¶€ì¡± -", reason.join(", "));
      }
    });
  </script>
</head>
<body>
  <p>ì£¼ì†Œë¥¼ ì„ íƒí•˜ì…¨ë‹¤ë©´ ì°½ì´ ìë™ìœ¼ë¡œ ë‹«í™ë‹ˆë‹¤.</p>
</body>
</html>